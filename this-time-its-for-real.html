<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title></title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.3.18 and GitBook 2.6.7">

  <meta property="og:title" content="" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="interacting-with-simple-data.html">
<link rel="next" href="learning-more.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Guide</a></li>
<li class="chapter" data-level="1" data-path="welcome-to-intro-to-r.html"><a href="welcome-to-intro-to-r.html"><i class="fa fa-check"></i><b>1</b> Welcome to Intro to R</a><ul>
<li class="chapter" data-level="1.1" data-path="welcome-to-intro-to-r.html"><a href="welcome-to-intro-to-r.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why R?</a></li>
<li class="chapter" data-level="1.2" data-path="welcome-to-intro-to-r.html"><a href="welcome-to-intro-to-r.html#when-to-use-r"><i class="fa fa-check"></i><b>1.2</b> When to use R?</a></li>
<li class="chapter" data-level="1.3" data-path="welcome-to-intro-to-r.html"><a href="welcome-to-intro-to-r.html#what-is-the-scope-of-this-workshop"><i class="fa fa-check"></i><b>1.3</b> What is the scope of this workshop?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="interacting-with-simple-data.html"><a href="interacting-with-simple-data.html"><i class="fa fa-check"></i><b>2</b> Interacting with Simple Data</a><ul>
<li class="chapter" data-level="2.1" data-path="interacting-with-simple-data.html"><a href="interacting-with-simple-data.html#what-is-rstudio"><i class="fa fa-check"></i><b>2.1</b> What is RStudio?</a></li>
<li class="chapter" data-level="2.2" data-path="interacting-with-simple-data.html"><a href="interacting-with-simple-data.html#coding-in-the-console"><i class="fa fa-check"></i><b>2.2</b> Coding in the console</a></li>
<li class="chapter" data-level="2.3" data-path="interacting-with-simple-data.html"><a href="interacting-with-simple-data.html#loading-in-data"><i class="fa fa-check"></i><b>2.3</b> Loading in data</a></li>
<li class="chapter" data-level="2.4" data-path="interacting-with-simple-data.html"><a href="interacting-with-simple-data.html#glancing-at-the-data"><i class="fa fa-check"></i><b>2.4</b> Glancing at the data</a></li>
<li class="chapter" data-level="2.5" data-path="interacting-with-simple-data.html"><a href="interacting-with-simple-data.html#visualizing-the-data"><i class="fa fa-check"></i><b>2.5</b> Visualizing the data</a></li>
<li class="chapter" data-level="2.6" data-path="interacting-with-simple-data.html"><a href="interacting-with-simple-data.html#modeling-the-data"><i class="fa fa-check"></i><b>2.6</b> Modeling the data</a></li>
<li class="chapter" data-level="2.7" data-path="interacting-with-simple-data.html"><a href="interacting-with-simple-data.html#working-with-a-simple-dataset"><i class="fa fa-check"></i><b>2.7</b> Working with a simple dataset</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="this-time-its-for-real.html"><a href="this-time-its-for-real.html"><i class="fa fa-check"></i><b>3</b> This time it’s for real!</a><ul>
<li class="chapter" data-level="3.1" data-path="this-time-its-for-real.html"><a href="this-time-its-for-real.html#loading-and-exploring-a-larger-dataset"><i class="fa fa-check"></i><b>3.1</b> Loading and exploring a larger dataset</a></li>
<li class="chapter" data-level="3.2" data-path="this-time-its-for-real.html"><a href="this-time-its-for-real.html#counting-missing-values"><i class="fa fa-check"></i><b>3.2</b> Counting missing values</a></li>
<li class="chapter" data-level="3.3" data-path="this-time-its-for-real.html"><a href="this-time-its-for-real.html#ignoring-missing-values"><i class="fa fa-check"></i><b>3.3</b> Ignoring missing values</a></li>
<li class="chapter" data-level="3.4" data-path="this-time-its-for-real.html"><a href="this-time-its-for-real.html#non-numeric-data"><i class="fa fa-check"></i><b>3.4</b> Non-numeric data</a><ul>
<li class="chapter" data-level="3.4.1" data-path="this-time-its-for-real.html"><a href="this-time-its-for-real.html#the-takeaway"><i class="fa fa-check"></i><b>3.4.1</b> The takeaway</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="this-time-its-for-real.html"><a href="this-time-its-for-real.html#analyzing-and-visualizing-the-data-using-a-script"><i class="fa fa-check"></i><b>3.5</b> Analyzing and Visualizing the data using a script</a><ul>
<li class="chapter" data-level="3.5.1" data-path="this-time-its-for-real.html"><a href="this-time-its-for-real.html#creating-a-r-script-to-save-code-and-analysis"><i class="fa fa-check"></i><b>3.5.1</b> Creating a R script to save code and analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="this-time-its-for-real.html"><a href="this-time-its-for-real.html#modeling-the-data-1"><i class="fa fa-check"></i><b>3.6</b> Modeling the data</a></li>
<li class="chapter" data-level="3.7" data-path="this-time-its-for-real.html"><a href="this-time-its-for-real.html#making-a-reproducible-report"><i class="fa fa-check"></i><b>3.7</b> Making a reproducible report</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="learning-more.html"><a href="learning-more.html"><i class="fa fa-check"></i><b>4</b> Learning More</a><ul>
<li class="chapter" data-level="4.1" data-path="learning-more.html"><a href="learning-more.html#how-to-get-help-in-r"><i class="fa fa-check"></i><b>4.1</b> How to get help in R</a></li>
<li class="chapter" data-level="4.2" data-path="learning-more.html"><a href="learning-more.html#next-steps"><i class="fa fa-check"></i><b>4.2</b> Next Steps</a><ul>
<li class="chapter" data-level="4.2.1" data-path="learning-more.html"><a href="learning-more.html#r-basics"><i class="fa fa-check"></i><b>4.2.1</b> R Basics</a></li>
<li class="chapter" data-level="4.2.2" data-path="learning-more.html"><a href="learning-more.html#r-for-data-science"><i class="fa fa-check"></i><b>4.2.2</b> R for Data Science</a></li>
<li class="chapter" data-level="4.2.3" data-path="learning-more.html"><a href="learning-more.html#practice-and-learn-data-science"><i class="fa fa-check"></i><b>4.2.3</b> Practice and Learn Data Science</a></li>
<li class="chapter" data-level="4.2.4" data-path="learning-more.html"><a href="learning-more.html#getting-help"><i class="fa fa-check"></i><b>4.2.4</b> Getting Help</a></li>
<li class="chapter" data-level="4.2.5" data-path="learning-more.html"><a href="learning-more.html#staying-up-to-date"><i class="fa fa-check"></i><b>4.2.5</b> Staying up to date</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="installation-instructions.html"><a href="installation-instructions.html"><i class="fa fa-check"></i><b>5</b> Installation Instructions</a><ul>
<li class="chapter" data-level="5.1" data-path="installation-instructions.html"><a href="installation-instructions.html#quick-installs"><i class="fa fa-check"></i><b>5.1</b> Quick installs</a><ul>
<li class="chapter" data-level="5.1.1" data-path="installation-instructions.html"><a href="installation-instructions.html#mac"><i class="fa fa-check"></i><b>5.1.1</b> Mac</a></li>
<li class="chapter" data-level="5.1.2" data-path="installation-instructions.html"><a href="installation-instructions.html#windows"><i class="fa fa-check"></i><b>5.1.2</b> Windows</a></li>
<li class="chapter" data-level="5.1.3" data-path="installation-instructions.html"><a href="installation-instructions.html#ubuntu"><i class="fa fa-check"></i><b>5.1.3</b> Ubuntu</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="installation-instructions.html"><a href="installation-instructions.html#r-for-mac-os-x"><i class="fa fa-check"></i><b>5.2</b> R for Mac OS X</a><ul>
<li class="chapter" data-level="5.2.1" data-path="installation-instructions.html"><a href="installation-instructions.html#option-1-cran"><i class="fa fa-check"></i><b>5.2.1</b> Option 1: CRAN</a></li>
<li class="chapter" data-level="5.2.2" data-path="installation-instructions.html"><a href="installation-instructions.html#option-2-homebrew"><i class="fa fa-check"></i><b>5.2.2</b> Option 2: Homebrew</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="installation-instructions.html"><a href="installation-instructions.html#r-for-windowslinux"><i class="fa fa-check"></i><b>5.3</b> R for Windows/Linux</a><ul>
<li class="chapter" data-level="5.3.1" data-path="installation-instructions.html"><a href="installation-instructions.html#windows-1"><i class="fa fa-check"></i><b>5.3.1</b> Windows</a></li>
<li class="chapter" data-level="5.3.2" data-path="installation-instructions.html"><a href="installation-instructions.html#linux"><i class="fa fa-check"></i><b>5.3.2</b> Linux</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="installation-instructions.html"><a href="installation-instructions.html#r-studio"><i class="fa fa-check"></i><b>5.4</b> R Studio</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>6</b> Appendix</a><ul>
<li class="chapter" data-level="6.1" data-path="appendix.html"><a href="appendix.html#webscraping-and-text-analysis"><i class="fa fa-check"></i><b>6.1</b> Webscraping and text analysis</a></li>
<li class="chapter" data-level="6.2" data-path="appendix.html"><a href="appendix.html#machine-learning-in-r"><i class="fa fa-check"></i><b>6.2</b> Machine Learning in R</a></li>
<li class="chapter" data-level="6.3" data-path="appendix.html"><a href="appendix.html#interactive-r-graphics"><i class="fa fa-check"></i><b>6.3</b> Interactive R Graphics</a></li>
<li class="chapter" data-level="6.4" data-path="appendix.html"><a href="appendix.html#maps"><i class="fa fa-check"></i><b>6.4</b> Maps</a></li>
<li class="chapter" data-level="6.5" data-path="appendix.html"><a href="appendix.html#handling-more-data"><i class="fa fa-check"></i><b>6.5</b> Handling more data</a></li>
<li class="chapter" data-level="6.6" data-path="appendix.html"><a href="appendix.html#general"><i class="fa fa-check"></i><b>6.6</b> General</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="this-time-its-for-real" class="section level1">
<h1><span class="header-section-number">3</span> This time it’s for real!</h1>
<p>Let’s pick up the pace and put our newfound skills to the test. For this section, we’re gonna use a dataset that looks more like what we’ll encounter in real life. It’s bigger in both dimensions; it has more rows but also more columns. It also has some missing data (oh noes!). Now things are getting real.</p>
<div id="loading-and-exploring-a-larger-dataset" class="section level2">
<h2><span class="header-section-number">3.1</span> Loading and exploring a larger dataset</h2>
<p>We can load our new dataset the same way as before, using the <code>read.csv()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">airquality &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;airquality.csv&#39;</span>)</code></pre></div>
<p>Let’s take a moment to explore the new dataset using tools we learned in the previous section. Try <code>str</code>, <code>head</code>, <code>summary</code> and get a good feel for the dataset. For example, we can find the number of rows using <code>nrow</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(magrittr) <span class="co"># load using `library` if not already loaded</span>
airquality %&gt;%<span class="st"> </span><span class="kw">nrow</span>()</code></pre></div>
<pre><code>## [1] 153</code></pre>
</div>
<div id="counting-missing-values" class="section level2">
<h2><span class="header-section-number">3.2</span> Counting missing values</h2>
<p>I mentioned this dataset has some missing data. You may have noticed it already when exploring. In R, missing values are represented by the <code>NA</code> symbol.</p>
<p>It’s always a good idea to check for missing values, even if you are <em>sure</em> your data is complete. We can ask R to tell us whether there are any <code>NA</code>s in the dataset using the <code>is.na()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">airquality %&gt;%<span class="st"> </span><span class="kw">is.na</span>()</code></pre></div>
<p>This will list out <code>TRUE</code> or <code>FALSE</code> for <em>every</em> value in <code>new_data</code>, for the question “is this value equal to <code>NA</code>?”. It’s kind hard to read, though.</p>
<p>If we wanted to get a general sense of how many <code>NA</code>s there were in our entire dataset, we could do something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">airquality %&gt;%<span class="st"> </span><span class="kw">is.na</span>() %&gt;%<span class="st"> </span><span class="kw">sum</span>()</code></pre></div>
<pre><code>## [1] 44</code></pre>
</div>
<div id="ignoring-missing-values" class="section level2">
<h2><span class="header-section-number">3.3</span> Ignoring missing values</h2>
<p>If we try to call some descriptive statistics on any columns with <code>NA</code> values, we will get an ugly result. Let’s try getting the mean for Ozone levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr) <span class="co"># load using `library` if not already loaded</span>
airquality %&gt;%<span class="st"> </span><span class="kw">summarise</span>(<span class="kw">mean</span>(Ozone))</code></pre></div>
<pre><code>##   mean(Ozone)
## 1          NA</code></pre>
<p>Not what we were looking for.</p>
<p>By default, many functions in R will return <code>NA</code> if called on a vector with any <code>NA</code> values inside. We can override this behavior by adding the <code>na.rm = TRUE</code> argument</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">airquality %&gt;%<span class="st"> </span><span class="kw">summarise</span>(<span class="kw">mean</span>(Ozone, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))</code></pre></div>
<pre><code>##   mean(Ozone, na.rm = TRUE)
## 1                  42.12931</code></pre>
<p>There are important questions to ask yourself when dealing with missing data; there’s no one-size-fits-all answer for it. A slapdash approach is to simply <em>remove</em> any rows with missing data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aircomplete &lt;-<span class="st"> </span>airquality %&gt;%<span class="st"> </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(airquality))</code></pre></div>
<p>If you call <code>nrow</code> on aircomplete, you’ll see we have 111 rows now instead of the 153 we had before.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aircomplete %&gt;%<span class="st"> </span><span class="kw">nrow</span>()</code></pre></div>
<pre><code>## [1] 111</code></pre>
</div>
<div id="non-numeric-data" class="section level2">
<h2><span class="header-section-number">3.4</span> Non-numeric data</h2>
<p>So far, we’ve primarily worked with numeric data.</p>
<p>Let’s talk briefly about how R handles string or character data.</p>
<p>Here’s a data frame with some letters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">letter=</span><span class="kw">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;l&quot;</span>,<span class="st">&quot;s&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;y&quot;</span>))</code></pre></div>
<p>Let’s look at the structure of the <em>myname</em> object, and the <em>letter</em> field of the object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname %&gt;%<span class="st"> </span><span class="kw">str</span>()</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    6 obs. of  1 variable:
##  $ letter: Factor w/ 5 levels &quot;e&quot;,&quot;k&quot;,&quot;l&quot;,&quot;s&quot;,..: 2 1 3 4 1 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname$letter %&gt;%<span class="st"> </span><span class="kw">str</span>()</code></pre></div>
<pre><code>##  Factor w/ 5 levels &quot;e&quot;,&quot;k&quot;,&quot;l&quot;,&quot;s&quot;,..: 2 1 3 4 1 5</code></pre>
<p>Hmm, it says <code>Factor w/ 5 levels &quot;e&quot;,&quot;k&quot;,&quot;l&quot;,&quot;s&quot;,..: 2 1 3 4 1 5</code>. What does this mean?</p>
<p>By default, R stores string fields in data frames as <em>factors</em>.</p>
<p>Behind the scenes, R identifies the unique character strings in the field, substitutes each one with a unique integer, and remembers the original strings as <em>levels</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname$letter %&gt;%<span class="st"> </span><span class="kw">levels</span>()</code></pre></div>
<pre><code>## [1] &quot;e&quot; &quot;k&quot; &quot;l&quot; &quot;s&quot; &quot;y&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname$letter %&gt;%<span class="st"> </span><span class="kw">as.integer</span>()</code></pre></div>
<pre><code>## [1] 2 1 3 4 1 5</code></pre>
<p>For many processes and analyses, this data structure will work fine.</p>
<p>In some situations, however, it becomes problematic.</p>
<p>Let’s try to modify the <em>myname</em> data frame, and make the letters spell out <em>kelsie</em> rather than <em>kelsey</em>.</p>
<p>We need to change the letter in the 6th position to <code>e</code> and the letter in the 5th position to <code>i</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname$letter[<span class="dv">6</span>] &lt;-<span class="st"> &quot;e&quot;</span>
myname$letter[<span class="dv">5</span>] &lt;-<span class="st"> &quot;i&quot;</span></code></pre></div>
<pre><code>## Warning in `[&lt;-.factor`(`*tmp*`, 5, value = structure(c(2L, 1L, 3L, 4L, :
## invalid factor level, NA generated</code></pre>
<p>Let’s print the updated data frame.</p>
<p>Not what we want.</p>
<p>There are a couple of ways to override R’s default behavior of storing text fields as columns.</p>
<p>If we’re creating a data frame from scratch, we can set the <em>stringsAsFactors</em> parameter equal to <em>FALSE</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">letter=</span><span class="kw">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;l&quot;</span>,<span class="st">&quot;s&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;y&quot;</span>), <span class="dt">stringsAsFactors=</span><span class="ot">FALSE</span>)</code></pre></div>
<p>Check out the structure <em>str</em> and see what is different.</p>
<p>Let’s try making the same modifications now.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname$letter[<span class="dv">6</span>] &lt;-<span class="st"> &quot;e&quot;</span>
myname$letter[<span class="dv">5</span>] &lt;-<span class="st"> &quot;i&quot;</span></code></pre></div>
<p>The character data type is much more flexible.</p>
<p>If we’ve already created (or read) a data frame, we can use the <em>as.character</em> function on the text field itself.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">letter=</span><span class="kw">c</span>(<span class="st">&quot;k&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;l&quot;</span>,<span class="st">&quot;s&quot;</span>,<span class="st">&quot;e&quot;</span>,<span class="st">&quot;y&quot;</span>))
myname %&gt;%<span class="st"> </span><span class="kw">str</span>()</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    6 obs. of  1 variable:
##  $ letter: Factor w/ 5 levels &quot;e&quot;,&quot;k&quot;,&quot;l&quot;,&quot;s&quot;,..: 2 1 3 4 1 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname$letter &lt;-<span class="st"> </span>myname$letter %&gt;%<span class="st"> </span><span class="kw">as.character</span>()
myname %&gt;%<span class="st"> </span><span class="kw">str</span>()</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    6 obs. of  1 variable:
##  $ letter: chr  &quot;k&quot; &quot;e&quot; &quot;l&quot; &quot;s&quot; ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">myname$letter[<span class="dv">6</span>] &lt;-<span class="st"> &quot;e&quot;</span>
myname$letter[<span class="dv">5</span>] &lt;-<span class="st"> &quot;i&quot;</span></code></pre></div>
<p>Looking out for factors is critical when typecasting numeric data that is mistakenly stored as text.</p>
<p>Here’s another data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fives &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">v1=</span><span class="kw">c</span>(<span class="st">&quot;5&quot;</span>,<span class="st">&quot;10&quot;</span>,<span class="st">&quot;15&quot;</span>,<span class="st">&quot;20&quot;</span>))</code></pre></div>
<p>Let’s look at the structure and levels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fives %&gt;%<span class="st"> </span><span class="kw">str</span>()</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4 obs. of  1 variable:
##  $ v1: Factor w/ 4 levels &quot;10&quot;,&quot;15&quot;,&quot;20&quot;,..: 4 1 2 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fives$v1 %&gt;%<span class="st"> </span><span class="kw">levels</span>()</code></pre></div>
<pre><code>## [1] &quot;10&quot; &quot;15&quot; &quot;20&quot; &quot;5&quot;</code></pre>
<p>We want these data points stored as a numeric type, but currently, they’re stored as text, and specifically as a factor.</p>
<p>What does it look like if we convert the factor to numeric?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fives$v1 %&gt;%<span class="st"> </span><span class="kw">as.numeric</span>()</code></pre></div>
<pre><code>## [1] 4 1 2 3</code></pre>
<p>So problematic! Why did this happen?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fives$v1 %&gt;%<span class="st"> </span><span class="kw">as.character</span>() %&gt;%<span class="st"> </span><span class="kw">as.numeric</span>()</code></pre></div>
<pre><code>## [1]  5 10 15 20</code></pre>
<p>That works as expected.</p>
<p>Are factors <em>ever</em> useful? Yes.</p>
<p>Here’s some pretend survey data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">survey &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">gender=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>), <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">7</span>)), <span class="dt">response=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Excellent&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Fair&quot;</span>, <span class="st">&quot;Poor&quot;</span>), <span class="dv">3</span>))</code></pre></div>
<p>Let’s change the levels of the gender field.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">survey$gender %&gt;%<span class="st"> </span><span class="kw">levels</span>()</code></pre></div>
<pre><code>## [1] &quot;Female&quot; &quot;Male&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(survey$gender) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;F&quot;</span>,<span class="st">&quot;M&quot;</span>)</code></pre></div>
<p>What does it look like now?</p>
<p>We can also take advantage of our understanding of the factor data type to convert the response variable into a numeric field.</p>
<p>I want <em>excellent</em> to map to 4, <em>good</em> to map to 3, <em>fair</em> to map to 2 and <em>poor</em> to map to 1.</p>
<p>We’ll use the <em>as.numeric</em> function eventually, but first we need to see if the levels are in the order that we want them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">survey$response %&gt;%<span class="st"> </span><span class="kw">levels</span>()</code></pre></div>
<pre><code>## [1] &quot;Excellent&quot; &quot;Fair&quot;      &quot;Good&quot;      &quot;Poor&quot;</code></pre>
<p>They’re not. Let’s change them, so that less favorable responses will appear before more favorable responses when alphabetized.</p>
<p>After we change the levels, we’ll need to turn the response field into a character field, and then re-factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(survey$response) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;D Excellent&quot;</span>,<span class="st">&quot;B Fair&quot;</span>,<span class="st">&quot;C Good&quot;</span>,<span class="st">&quot;A Poor&quot;</span>)
survey$response &lt;-<span class="st"> </span>survey$response %&gt;%<span class="st"> </span><span class="kw">as.character</span>() %&gt;%<span class="st"> </span><span class="kw">as.factor</span>()
survey$response %&gt;%<span class="st"> </span><span class="kw">levels</span>()</code></pre></div>
<pre><code>## [1] &quot;A Poor&quot;      &quot;B Fair&quot;      &quot;C Good&quot;      &quot;D Excellent&quot;</code></pre>
<p>Much better. Now we can call the <em>as.numeric</em> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">survey %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="kw">as.numeric</span>(response))</code></pre></div>
<pre><code>##    gender    response as.numeric(response)
## 1       M D Excellent                    4
## 2       M      C Good                    3
## 3       M      B Fair                    2
## 4       M      A Poor                    1
## 5       M D Excellent                    4
## 6       F      C Good                    3
## 7       F      B Fair                    2
## 8       F      A Poor                    1
## 9       F D Excellent                    4
## 10      F      C Good                    3
## 11      F      B Fair                    2
## 12      F      A Poor                    1</code></pre>
<p>How useful!</p>
<div id="the-takeaway" class="section level3">
<h3><span class="header-section-number">3.4.1</span> The takeaway</h3>
<p>By default, R stores text fields as factors. And factors are strange.</p>
<p>At times it seems like they are working against us.</p>
<p>But if we understand how they work, we can make them work for us!</p>
<p>Now, back to numeric data.</p>
</div>
</div>
<div id="analyzing-and-visualizing-the-data-using-a-script" class="section level2">
<h2><span class="header-section-number">3.5</span> Analyzing and Visualizing the data using a script</h2>
<div id="creating-a-r-script-to-save-code-and-analysis" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Creating a R script to save code and analysis</h3>
<p>Now, I want you to go back and do <em>everything</em> we just did over again.</p>
<p>What, you think that’s ridiculous? The reality is, we often have to go back and make changes upstream. When we do this, it can get very, very painful if we’re doing everything interactively, in the <em>console</em>.</p>
<p>In all our previous examples we have been using the interactive console. It is an excellent application to quickly analyze the data, but we need to keep a reasonable log of what we did (and possibly way).</p>
<p>Let us start by creating a file, with all the <code>commands</code> we used in a sequence.</p>
<p>Click the symbol for New Script and you’ll see RStudio’s built-in text editor pop up.</p>
<p><img src="assets/create_new_file.png" style="width:400px"></p>
<p>And then we will clear the session, to remove all the variables from the environment. This insures that we are starting with a clean slate.</p>
<p><img src="assets/clear_session1.png" style="width:400px"></p>
<p><img src="assets/clear_session2.png" style="width:304px"></p>
<p>Let’s take a moment to put all our work in. I know it’s a pain but it will pay off if we want to make changes later.</p>
<p>It is good practice, in programming to place all the libraries we need at the top. Imagine arranging all the ingredients before we start following a recipie for our dish.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load libraries</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(dplyr)

<span class="co"># read in data</span>
airquality &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;airquality.csv&#39;</span>)</code></pre></div>
<p>We can start by visualizing the data. We have more data to play with now, but let’s start with the same plot we used last time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot to compare temperature vs ozone</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(airquality) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Temp, <span class="dt">y=</span>Ozone))
<span class="kw">print</span>(p)</code></pre></div>
<pre><code>## Warning: Removed 37 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p>You’ll notice two new things about what we did here. First, we assign the output to <code>p</code>, this will be important when we want to make adjustments to the plot later. Second, you’ll notice when we do that, nothing appears; we have to print the <code>p</code> to get it to show up.</p>
<p>Notice how we get warning messages, with NA’s, let use <code>complete.cases</code> function, to filter out such rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># filter for only complete cases</span>
aircomplete &lt;-<span class="st"> </span><span class="kw">filter</span>(airquality, <span class="kw">complete.cases</span>(airquality))

<span class="co"># create a plot comparing, Ozone levels with Temperature</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(aircomplete) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Temp, <span class="dt">y=</span>Ozone))
<span class="kw">print</span>(p)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>We can run the entire script by clicking <em>Source</em> at the top of the editor pane.</p>
<p>To run just a specific line or lines, you can select the section you want to run and then click <em>Run</em>.</p>
<p>Let’s get back to our data. You may have seen a pattern in the plot we made earlier. Let’s pick up our analysis with a little more visualization and some modeling.</p>
</div>
</div>
<div id="modeling-the-data-1" class="section level2">
<h2><span class="header-section-number">3.6</span> Modeling the data</h2>
<p>We’ll model the data using the reliable <code>lm()</code> function again. Let’s add the following to the end of our script and <em>source</em> it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ozone_model &lt;-<span class="st"> </span><span class="kw">lm</span>(Ozone ~<span class="st"> </span>Temp, <span class="dt">data =</span> aircomplete)
<span class="kw">print</span>(<span class="kw">summary</span>(ozone_model))</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Ozone ~ Temp, data = aircomplete)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -40.922 -17.459  -0.874  10.444 118.078 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -147.6461    18.7553  -7.872 2.76e-12 ***
## Temp           2.4391     0.2393  10.192  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 23.92 on 109 degrees of freedom
## Multiple R-squared:  0.488,  Adjusted R-squared:  0.4833 
## F-statistic: 103.9 on 1 and 109 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Our model tells us there is a <em>statistically significant</em> relationship between Ozone and Temperature. If we want to add the linear model to our plot, we can use the <code>geom_abline()</code> function. <code>geom_abline()</code> takes two arguments, the intercept and slope. We can use the <code>coef()</code> function to extract those values from the model. Add the following lines to your script and <em>Source</em> it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_coefs =<span class="st"> </span><span class="kw">coef</span>(ozone_model)
<span class="kw">print</span>(lm_coefs)</code></pre></div>
<pre><code>## (Intercept)        Temp 
##  -147.64607     2.43911</code></pre>
<p>With that info, we’re ready to add our linear model. Add the following lines to your script and <em>Source</em> it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> -<span class="fl">147.64607</span> , <span class="dt">slope =</span> <span class="fl">2.43911</span>)
<span class="kw">print</span>(p2)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p><strong>bonus</strong></p>
<p>We would go a little further, and bin the temperature variable into <code>high</code> and <code>low</code>, to enable comparison with ozone levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aircomplete =<span class="st"> </span><span class="kw">mutate</span>(aircomplete,
  <span class="dt">temp2 =</span> <span class="kw">ifelse</span>(Temp &gt;<span class="st"> </span><span class="dv">80</span>, <span class="st">&quot;high&quot;</span>, <span class="st">&quot;low&quot;</span>))</code></pre></div>
<p>Next, let us create a box plot using this new <code>temp2</code> variable. We would use <code>geom_boxplot</code> from ggplot2 to create this plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(aircomplete) +<span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>temp2, <span class="dt">y=</span>Ozone))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<p>We see that low shows up after high on the x axis, and it is counter intuitive. This is because <code>temp2</code> is a character, and ggplot2 sorts this variable alphabetically (<strong>h</strong> of high orders before <strong>l</strong> of low). So we can use factors, as explained in the previous section to switch their position.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aircomplete =<span class="st"> </span><span class="kw">mutate</span>(aircomplete,
  <span class="dt">temp_fac =</span> <span class="kw">factor</span>(temp2, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)))</code></pre></div>
<p>We are using <code>mutate</code> from <code>dplyr</code> to add a new column <code>temp_fac</code>; which is a factor version of <code>temp2</code>. Also, you will notice we have explicitly specified the levels in a order we would like (<code>low</code> and <code>high</code>).</p>
<p>Alright! Now lets see how <code>temp_fac</code>, comes to use in our boxplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(aircomplete) +<span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>temp_fac, <span class="dt">y=</span>Ozone))</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
</div>
<div id="making-a-reproducible-report" class="section level2">
<h2><span class="header-section-number">3.7</span> Making a reproducible report</h2>
<p>Great. Now, what if we want to make a report of our work? With R, you get the power of <code>knitr</code>, which will <em>knit</em> your work together into a report. Let’s try it on our current script. Go to File -&gt; Knit Document, name the file <code>airquality_report</code> and select HTML, then watch the magic happen!</p>
<p>Here is a link to an example script:</p>
<ul>
<li><a href="https://github.com/HoustonUseRs/intro-to-R-guide/blob/master/example_script.R">example_script.R</a></li>
<li><a href="example_script.html" class="uri">example_script.html</a></li>
</ul>
<p>R basically convert the R script into markdown, and then into HTML. So have have the option of including some additional markdown instructions in this set. We need just to prefix all lines with a <code>#'</code> to use markdown</p>
<p>Here are a set of a few markdown examples.</p>
<p><img src="assets/markdown_help.png" style="width:304px"></p>

</div>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-85305694-2', 'auto');
  ga('send', 'pageview');
</script>
            </section>

          </div>
        </div>
      </div>
<a href="interacting-with-simple-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="learning-more.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
